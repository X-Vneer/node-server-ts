import{r as Q,R as A}from"./index.df40002d.js";function tt(){return tt=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])}return n},tt.apply(this,arguments)}var R=function(o,a){return o.querySelector(a)},$t=function(o,a){return o.querySelectorAll(a)},Et=function(o){o===void 0&&(o={});var a={};return Object.keys(o).forEach(function(r){typeof o[r]<"u"&&(a[r]=o[r])}),a};function Nt(n){n===void 0&&(n={});var o=n,a=o.el,r=o.eventsEl,c={__atropos__:!0,params:tt({alwaysActive:!1,activeOffset:50,shadowOffset:50,shadowScale:1,duration:300,rotate:!0,rotateTouch:!0,rotateXMax:15,rotateYMax:15,rotateXInvert:!1,rotateYInvert:!1,stretchX:0,stretchY:0,stretchZ:0,commonOrigin:!0,shadow:!0,highlight:!0,onEnter:null,onLeave:null,onRotate:null},Et(n||{})),destroyed:!1,isActive:!1},e=c.params,x,E,F,P,Y,p,f,N,K,j,h=[],d,W=function s(){d=requestAnimationFrame(function(){h.forEach(function(t){if(typeof t=="function")t();else{var i=t.element,u=t.prop,l=t.value;i.style[u]=l}}),h.splice(0,h.length),s()})};W();var m=function(t,i){h.push({element:t,prop:"transitionDuration",value:i})},C=function(t,i){h.push({element:t,prop:"transitionTimingFunction",value:i})},w=function(t,i){h.push({element:t,prop:"transform",value:i})},L=function(t,i){h.push({element:t,prop:"opacity",value:i})},q=function(t,i){h.push({element:t,prop:"transformOrigin",value:i})},$=function(t,i,u,l){return t.addEventListener(i,u,l)},M=function(t,i,u,l){return t.removeEventListener(i,u,l)},z=function(){var t;p=R(a,".atropos-shadow"),p||(p=document.createElement("span"),p.classList.add("atropos-shadow"),t=!0),w(p,"translate3d(0,0,-"+e.shadowOffset+"px) scale("+e.shadowScale+")"),t&&x.appendChild(p)},ut=function(){var t;f=R(a,".atropos-highlight"),f||(f=document.createElement("span"),f.classList.add("atropos-highlight"),t=!0),w(f,"translate3d(0,0,0)"),t&&F.appendChild(f)},G=function(t){var i=t.rotateXPercentage,u=i===void 0?0:i,l=t.rotateYPercentage,v=l===void 0?0:l,g=t.duration,_=t.opacityOnly,b=t.easeOut,D=function(O){if(O.dataset.atroposOpacity&&typeof O.dataset.atroposOpacity=="string")return O.dataset.atroposOpacity.split(";").map(function(X){return parseFloat(X)})};$t(a,"[data-atropos-offset], [data-atropos-opacity]").forEach(function(y){m(y,g),C(y,b?"ease-out":"");var O=D(y);if(u===0&&v===0)_||w(y,"translate3d(0, 0, 0)"),O&&L(y,O[0]);else{var X=parseFloat(y.dataset.atroposOffset)/100;if(!Number.isNaN(X)&&!_&&w(y,"translate3d("+-v*-X+"%, "+u*-X+"%, 0)"),O){var B=O[0],V=O[1],k=Math.max(Math.abs(u),Math.abs(v));L(y,B+(V-B)*k/100)}}})},J=function(t,i){var u=a!==r;if(P||(P=a.getBoundingClientRect()),u&&!Y&&(Y=r.getBoundingClientRect()),typeof t>"u"&&typeof i>"u"){var l=u?Y:P;t=l.left+l.width/2,i=l.top+l.height/2}var v=0,g=0,_=P,b=_.top,D=_.left,y=_.width,O=_.height,X;if(u){var H=Y,ot=H.top,it=H.left,pt=H.width,dt=H.height,ht=D-it,mt=b-ot,gt=y/2+ht,yt=O/2+mt,Ot=t-it,Mt=i-ot;g=e.rotateYMax*(Ot-gt)/(pt-y/2)*-1,v=e.rotateXMax*(Mt-yt)/(dt-O/2),X=t-D+"px "+(i-b)+"px"}else{var B=y/2,V=O/2,k=t-D,vt=i-b;g=e.rotateYMax*(k-B)/(y/2)*-1,v=e.rotateXMax*(vt-V)/(O/2)}v=Math.min(Math.max(-v,-e.rotateXMax),e.rotateXMax),e.rotateXInvert&&(v=-v),g=Math.min(Math.max(-g,-e.rotateYMax),e.rotateYMax),e.rotateYInvert&&(g=-g);var I=v/e.rotateXMax*100,S=g/e.rotateYMax*100,wt=(u?S/100*e.stretchX:0)*(e.rotateYInvert?-1:1),xt=(u?I/100*e.stretchY:0)*(e.rotateXInvert?-1:1),Ct=u?Math.max(Math.abs(I),Math.abs(S))/100*e.stretchZ:0;w(x,"translate3d("+wt+"%, "+-xt+"%, "+-Ct+"px) rotateX("+v+"deg) rotateY("+g+"deg)"),X&&e.commonOrigin&&q(x,X),f&&(m(f,e.duration+"ms"),C(f,"ease-out"),w(f,"translate3d("+-S*.25+"%, "+I*.25+"%, 0)"),L(f,Math.max(Math.abs(I),Math.abs(S))/100)),G({rotateXPercentage:I,rotateYPercentage:S,duration:e.duration+"ms",easeOut:!0}),typeof e.onRotate=="function"&&e.onRotate(v,g)},et=function(){h.push(function(){return a.classList.add("atropos-active")}),m(x,e.duration+"ms"),C(x,"ease-out"),w(E,"translate3d(0,0, "+e.activeOffset+"px)"),m(E,e.duration+"ms"),C(E,"ease-out"),p&&(m(p,e.duration+"ms"),C(p,"ease-out")),c.isActive=!0},Z=function(t){if(N=void 0,!(t.type==="pointerdown"&&t.pointerType==="mouse")&&!(t.type==="pointerenter"&&t.pointerType!=="mouse")){if(t.type==="pointerdown"&&t.preventDefault(),K=t.clientX,j=t.clientY,e.alwaysActive){P=void 0,Y=void 0;return}et(),typeof e.onEnter=="function"&&e.onEnter()}},at=function(t){N===!1&&t.cancelable&&t.preventDefault()},rt=function(t){if(!(!e.rotate||!c.isActive)){if(t.pointerType!=="mouse"){if(!e.rotateTouch)return;t.preventDefault()}var i=t.clientX,u=t.clientY,l=i-K,v=u-j;if(typeof e.rotateTouch=="string"&&(l!==0||v!==0)&&typeof N>"u"){if(l*l+v*v>=25){var g=Math.atan2(Math.abs(v),Math.abs(l))*180/Math.PI;N=e.rotateTouch==="scroll-y"?g>45:90-g>45}N===!1&&(a.classList.add("atropos-rotate-touch"),t.cancelable&&t.preventDefault())}t.pointerType!=="mouse"&&N||J(i,u)}},T=function(t){if(P=void 0,Y=void 0,!!c.isActive&&!(t&&t.type==="pointerup"&&t.pointerType==="mouse")&&!(t&&t.type==="pointerleave"&&t.pointerType!=="mouse")){if(typeof e.rotateTouch=="string"&&N&&a.classList.remove("atropos-rotate-touch"),e.alwaysActive){J(),typeof e.onRotate=="function"&&e.onRotate(0,0),typeof e.onLeave=="function"&&e.onLeave();return}h.push(function(){return a.classList.remove("atropos-active")}),m(E,e.duration+"ms"),C(E,""),w(E,"translate3d(0,0, "+0+"px)"),p&&(m(p,e.duration+"ms"),C(p,"")),f&&(m(f,e.duration+"ms"),C(f,""),w(f,"translate3d(0, 0, 0)"),L(f,0)),m(x,e.duration+"ms"),C(x,""),w(x,"translate3d(0,0,0) rotateX(0deg) rotateY(0deg)"),G({duration:e.duration+"ms"}),c.isActive=!1,typeof e.onRotate=="function"&&e.onRotate(0,0),typeof e.onLeave=="function"&&e.onLeave()}},nt=function(t){var i=t.target;!r.contains(i)&&i!==r&&c.isActive&&T()},ct=function(){typeof a=="string"&&(a=R(document,a)),a&&(a.__atropos__||(typeof r<"u"?typeof r=="string"&&(r=R(document,r)):r=a,Object.assign(c,{el:a}),x=R(a,".atropos-rotate"),E=R(a,".atropos-scale"),F=R(a,".atropos-inner"),a.__atropos__=c))},ft=function(){ct(),!(!a||!r)&&(e.shadow&&z(),e.highlight&&ut(),e.rotateTouch&&(typeof e.rotateTouch=="string"?a.classList.add("atropos-rotate-touch-"+e.rotateTouch):a.classList.add("atropos-rotate-touch")),R(a,"[data-atropos-opacity]")&&G({opacityOnly:!0}),$(document,"click",nt),$(r,"pointerdown",Z),$(r,"pointerenter",Z),$(r,"pointermove",rt),$(r,"touchmove",at),$(r,"pointerleave",T),$(r,"pointerup",T),$(r,"lostpointercapture",T),e.alwaysActive&&(et(),J()))},lt=function(){c.destroyed=!0,cancelAnimationFrame(d),M(document,"click",nt),M(r,"pointerdown",Z),M(r,"pointerenter",Z),M(r,"pointermove",rt),M(r,"touchmove",at),M(r,"pointerleave",T),M(r,"pointerup",T),M(r,"lostpointercapture",T),delete a.__atropos__};return c.destroy=lt,ft(),c}var Pt=["component","children","rootChildren","scaleChildren","rotateChildren","className","scaleClassName","rotateClassName","innerClassName"];function U(){return U=Object.assign||function(n){for(var o=1;o<arguments.length;o++){var a=arguments[o];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(n[r]=a[r])}return n},U.apply(this,arguments)}function Xt(n,o){if(n==null)return{};var a={},r=Object.keys(n),c,e;for(e=0;e<r.length;e++)c=r[e],!(o.indexOf(c)>=0)&&(a[c]=n[c]);return a}var st=["eventsEl","alwaysActive","activeOffset","shadowOffset","shadowScale","duration","rotate","rotateTouch","rotateXMax","rotateYMax","rotateXInvert","rotateYInvert","stretchX","stretchY","stretchZ","commonOrigin","shadow","highlight","onEnter","onLeave","onRotate"],Yt=function(o){var a={};return Object.keys(o).forEach(function(r){st.includes(r)||(a[r]=o[r])}),a},Rt=function(o){var a={};return Object.keys(o).forEach(function(r){st.includes(r)&&(a[r]=o[r])}),a};function Tt(n){var o=n.component,a=o===void 0?"div":o,r=n.children,c=n.rootChildren,e=n.scaleChildren,x=n.rotateChildren,E=n.className,F=E===void 0?"":E,P=n.scaleClassName,Y=P===void 0?"":P,p=n.rotateClassName,f=p===void 0?"":p,N=n.innerClassName,K=N===void 0?"":N,j=Xt(n,Pt),h=Q.useRef(null),d=Q.useRef(null),W=a,m=function(){for(var q=arguments.length,$=new Array(q),M=0;M<q;M++)$[M]=arguments[M];return $.filter(function(z){return!!z}).join(" ")},C=function(){d.current=Nt(U({el:h.current},Rt(n)))},w=function(){d.current&&(d.current.destroy(),d.current=null)};return Q.useEffect(function(){return h.current&&C(),function(){w()}},[]),Q.useEffect(function(){return d.current&&(d.current.params.onEnter=n.onEnter,d.current.params.onLeave=n.onLeave,d.current.params.onRotate=n.onRotate),function(){d.current&&(d.current.params.onEnter=null,d.current.params.onLeave=null,d.current.params.onRotate=null)}}),A.createElement(W,U({className:m("atropos",F)},Yt(j),{ref:h}),A.createElement("span",{className:m("atropos-scale",Y)},A.createElement("span",{className:m("atropos-rotate",f)},A.createElement("span",{className:m("atropos-inner",K)},r,(n.highlight||typeof n.highlight>"u")&&A.createElement("span",{className:"atropos-highlight"})),x,(n.shadow||typeof n.shadow>"u")&&A.createElement("span",{className:"atropos-shadow"})),e),c)}export{Tt as A};
